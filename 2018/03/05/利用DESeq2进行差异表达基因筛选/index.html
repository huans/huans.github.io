<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 转录组分析之--利用DESeq2进行差异基因的筛选 · Huan's blog</title><meta name="description" content="转录组分析之--利用DESeq2进行差异基因的筛选 - Huan Si"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://huans.github.io/atom.xml" title="Huan's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/huans" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="http://cotton.hzau.edu.cn/" target="_blank" class="nav-list-link">LAB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">转录组分析之--利用DESeq2进行差异基因的筛选</h1><div class="post-info">Mar 5, 2018</div><div class="post-content"><p>绝对算不上闲来无事，一是不闲，二是有事，转录组分析算是比较常见的生物信息分析内容，加之最近确实有课题与之相关，无论如何，花些时间自己做一遍增加理解也可以接受.<a id="more"></a><br>1.DESeq2的安装<br>source(“<a href="https://bioconductor.org/biocLite.R" target="_blank" rel="noopener">https://bioconductor.org/biocLite.R</a>“)<br>biocLite(“DESeq2”)<br>2.读取数据</p>
<pre><code>library(DESeq2)
data&lt;-read.table(&quot;W_H_S_30min.readcount.txt&quot;,header=T,row.names=1)
head(data)
</code></pre><p>design&lt;-rep(c(“W10”,”H10”,”S10”,”W30”,”H30”,”S30”,”W60”,”H60”,”S60”,”W240”,”H240”,”S240”),each=3)#3类处理，9个样本</p>
<p>3.构建dds对象<br>colData &lt;- data.frame(row.names=colnames(data),group_list=design)<br>dds &lt;- DESeqDataSetFromMatrix(countData = data,colData = colData,design = ~group_list)<br>4.做normalization<br>dds2 &lt;- DESeq(dds)<br>5.提取数据<br>res &lt;-  results(dds2, contrast=c(“group_list”,”S30”,”W30”))#这里提取的是S30与W30作比较<br>resOrdered &lt;- res[order(res$padj),]<br>resOrdered=as.data.frame(resOrdered)<br>head(resOrdered)<br>6.进行数据的过滤<br>要选择fold change大于4，padj小于0.05|0.01的基因<br>final.res &lt;- na.omit(resOrdered[abs(resOrdered$log2FoldChange)&gt;2 &amp; resOrdered$padj&lt;0.01,])<br>write.table(final.res,”S30_W30_Sigene.txt”,sep=”\t”)</p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/03/05/GO和pathway富集分析/" class="prev">PREV</a><a href="/2017/12/19/First-blog/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'huan-1';
var disqus_identifier = '2018/03/05/利用DESeq2进行差异表达基因筛选/';
var disqus_title = '转录组分析之--利用DESeq2进行差异基因的筛选';
var disqus_url = 'https://huans.github.io/2018/03/05/利用DESeq2进行差异表达基因筛选/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//huan-1.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2018 <a href="https://huans.github.io">Huan Si</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>